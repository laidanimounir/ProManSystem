<Window x:Class="ProManSystem.Views.CustomerPickerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Sélection du Client" 
        Height="613" 
        Width="900"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        MinHeight="500"
        MinWidth="800"
        Background="#F8FAFC">

    <Window.Resources>

        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="12,0"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#CBD5E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#1E3A8A"/>
                    <Setter Property="BorderThickness" Value="2"/>
                </Trigger>
            </Style.Triggers>
        </Style>


        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="#10B981"/>
            <Setter Property="Padding" Value="20,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#059669"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#047857"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="#64748B"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#475569"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="AccentButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="#1E3A8A"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1E40AF"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="#1E3A8A" Padding="20,16">
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="👤" FontSize="28" Margin="0,0,12,0"/>
                    <StackPanel>
                        <TextBlock Text="Sélection du Client"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <TextBlock Text="Recherchez et sélectionnez un client pour la facture"
                                   FontSize="12"
                                   Foreground="#BFDBFE"
                                   Margin="0,3,0,0"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>


        <Border Grid.Row="1" 
                Background="White"
                Margin="15"
                CornerRadius="8"
                BorderBrush="#E2E8F0"
                BorderThickness="1">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Opacity="0.08"
                                  BlurRadius="12" ShadowDepth="3"/>
            </Border.Effect>

            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="16"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="16"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>


                <Border Grid.Row="0"
                        Background="#F8FAFC"
                        CornerRadius="8"
                        Padding="16"
                        BorderBrush="#E2E8F0"
                        BorderThickness="1">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="12"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Grid Grid.Column="0">
                            <TextBox x:Name="SearchTextBox"
                                     Style="{StaticResource ModernTextBox}"
                                     Padding="40,0,12,0"/>
                            <TextBlock Text="🔍"
                                       FontSize="16"
                                       Foreground="#94A3B8"
                                       IsHitTestVisible="False"
                                       VerticalAlignment="Center"
                                       Margin="12,0,0,0"/>
                            <TextBlock Text="Rechercher par code, nom, ou activité..."
                                       FontSize="13"
                                       Foreground="#94A3B8"
                                       IsHitTestVisible="False"
                                       VerticalAlignment="Center"
                                       Margin="40,0,12,0">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Text, ElementName=SearchTextBox}" Value="">
                                                <Setter Property="Visibility" Value="Visible"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>


                        <Button Grid.Column="2"
                                Content="🔍 Rechercher"
                                Width="140"
                                Style="{StaticResource AccentButton}"
                                Click="SearchButton_Click"/>
                    </Grid>
                </Border>


                <Border Grid.Row="2"
                        Background="White"
                        CornerRadius="8"
                        BorderBrush="#E2E8F0"
                        BorderThickness="1">
                    <DataGrid x:Name="CustomersGrid"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              CanUserResizeRows="False"
                              SelectionMode="Single"
                              BorderThickness="0"
                              GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="#E2E8F0"
                              AlternatingRowBackground="#F8FAFC"
                              FontSize="13"
                              RowHeight="48"
                              ColumnHeaderHeight="50"
                              MouseDoubleClick="CustomersGrid_MouseDoubleClick">

                        <DataGrid.Resources>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="Background" Value="#1E3A8A"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                                <Setter Property="FontSize" Value="13"/>
                                <Setter Property="Padding" Value="12,10"/>
                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                            </Style>

                            <Style TargetType="DataGridRow">
                                <Setter Property="Background" Value="White"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#DBEAFE"/>
                                        <Setter Property="Cursor" Value="Hand"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#93C5FD"/>
                                        <Setter Property="Foreground" Value="#1E293B"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>

                            <Style TargetType="DataGridCell">
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="Padding" Value="12,0"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="#1E293B"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.Resources>

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Code Client"
                                                Binding="{Binding CodeClient}"
                                                Width="110"/>

                            <DataGridTextColumn Header="Nom Complet"
                                                Binding="{Binding NomComplet}"
                                                Width="*"
                                                MinWidth="180"/>

                            <DataGridTextColumn Header="Activité"
                                                Binding="{Binding Activite}"
                                                Width="150"/>

                            <DataGridTextColumn Header="Téléphone"
                                                Binding="{Binding Telephone}"
                                                Width="120"/>

                            <DataGridTextColumn Header="Adresse"
                                                Binding="{Binding Adresse}"
                                                Width="200"/>

                            <DataGridTextColumn Header="CA TTC"
                                                Binding="{Binding CA_TTC, StringFormat=N2}"
                                                Width="110"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>


                <Border Grid.Row="3"
                        Background="#EFF6FF"
                        CornerRadius="6"
                        Padding="12"
                        BorderBrush="#3B82F6"
                        BorderThickness="1" Margin="0,16,0,10" Grid.RowSpan="2">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="💡"
                                   FontSize="16"
                                   Margin="0,0,10,0"
                                   VerticalAlignment="Center"/>
                        <TextBlock Text="Double-cliquez sur un client pour le sélectionner rapidement"
                                   FontSize="12"
                                   Foreground="#1E40AF"
                                   FontWeight="SemiBold"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>


        <Border Grid.Row="1"
                Background="White"
                BorderBrush="#E2E8F0"
                BorderThickness="0,1,0,0"
                VerticalAlignment="Top"
                Padding="20,12" Height="94" Margin="0,425,0,0">
            <Grid>
                <StackPanel Orientation="Horizontal" Margin="0,-13,0,0">
                    <TextBlock Text="📊"
                               FontSize="16"
                               Margin="0,0,8,0"
                               VerticalAlignment="Center"/>
                    <TextBlock x:Name="CountTextBlock"
                               Text="0 client(s) trouvé(s)"
                               FontSize="13"
                               FontWeight="SemiBold"
                               Foreground="#64748B"
                               VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    <Button x:Name="CancelButton"
                            Content="❌ Annuler"
                            Width="130"
                            Margin="0,0,10,0"
                            Style="{StaticResource SecondaryButton}"
                            Click="CancelButton_Click" Height="46"/>

                    <Button x:Name="SelectButton"
                            Content="✅ Sélectionner"
                            Width="150"
                            Style="{StaticResource PrimaryButton}"
                            Click="SelectButton_Click"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
